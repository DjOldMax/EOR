<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Без названия.&nbsp;4.3.4. Использование хэш функций при решении практических задач</title>
    <meta charset="UTF-8"> 
    <meta name="generator" content="SunRav BookEditor"> 	
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="4.3.4. Использование хэш функций при решении практических задач">
    <link href="theme/bootstrap.min.css" rel="stylesheet">
    <link href="theme/simple-sidebar.css" rel="stylesheet">
	<link href="styles.css" rel="stylesheet">   

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav"><li class="sidebar-brand"><a href="index.html">Без названия</a></li><li ><a href='20.html'>&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Учебное пособие КМЗИ</a></li><li ><a href='1160.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Титульный экран</a></li><li ><a href='1170.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Оглавление</a></li><li ><a href='40.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Предисловие</a></li><li ><a href='50.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;1. Основы криптографии как науки о засекречивании информации</a></li><li ><a href='70.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;2. Криптографические нападения и понятие о криптоанализе, надежность шифров</a></li><li ><a href='80.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3. Современные блочные шифры и методы из криптоанализа</a></li><li ><a href='90.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4. Вспомогательные криптографические примитивы</a></li><li ><a href='220.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4.1. Вероятностное шифрование</a></li><li ><a href='230.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4.2. Блочные шифры на основе управляемых операций</a></li><li ><a href='240.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4.3. Криптографические хэш функции</a></li><li ><a href='760.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;4.3.1. Структура и свойства хэш-функций</a></li><li ><a href='770.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;4.3.2. Построение хэш-функций на основе блочных шифров</a></li><li ><a href='780.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;4.3.3. Примеры хэш функций</a></li><li class='sidebar-active'><a href='790.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;4.3.4. Использование хэш функций при решении практических задач</a></li><li ><a href='1780.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Контрольные вопросы</a></li><li ><a href='250.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4.4. Поточные алгоритмы шифрования</a></li><li ><a href='1280.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Тест к главе 4</a></li><li ><a href='100.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;5. Криптосистемы с открытым ключом</a></li><li ><a href='110.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;6. Криптографические методы в современных средствах защиты информации в компьютерных системах</a></li><li ><a href='1320.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Справочные материалы</a></li><li ><a href='2020.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Список литературы</a></li>            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <h1><a title="Показать/скрыть меню" href="#menu-toggle" class="btn btn-default" id="menu-toggle"><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span></a> 4.3.4. Использование хэш функций при решении практических задач</h1>
						<hr>
                        <h3 class=rvps1022><span class=rvts0><span class=rvts29>4.3.4. Использование хэш функций при решении практических задач</span></span></h3>
<p class=rvps4><span class=rvts30><br></span></p>
<h4 class=rvps1331><span class=rvts0><span class=rvts50>Проверка подлинности сообщения</span></span></h4>
<p class=rvps767><span class=rvts4>Коды проверки подлинности сообщения (MAC или имитовставка) обладают теми же свойствами, что и хэш функции, но при этом зависят от секретного ключа. Схема применения MAC кодов представлена на рис. 4.27. Коды проверки подлинности сообщения могут использоваться для проверки целостности и авторства сообщения. Для этого отправитель вычисляет MAC код сообщения и присоединяет его к сообщению, при этом сообщение может быть как открытым, так и зашифрованным. На приемной стороне получатель также вычисляет MAC код сообщения и сравнивает полученный код и вычисленный. Если они совпадают, значит сообщение не было модифицировано и получено от легального абонента </span><span class=rvts1638>−</span><span class=rvts4> владельца секретного ключа.</span></p>
<p class=rvps767><span class=rvts4><br></span></p>
<div class=rvps969><table border=0 cellpadding=4 cellspacing=0 style="border-width: 0px; border-spacing: 0px; margin: 0px auto;">
<tr valign=top>
<td width=628 valign=top style="padding: 0px 7px;"><p class=rvps969><img alt="" style="padding : 1px;" src="img/img_00442.png"></p>
</td>
</tr>
<tr valign=top>
<td width=628 valign=top style="padding: 0px 7px;"><p class=rvps1339><span class=rvts51>Рис. 4.27. Схема проверки подлинности сообщения</span></p>
<p class=rvps969><span class=rvts4><br></span></p>
</td>
</tr>
</table>
</div>
<p class=rvps767><span class=rvts4>Если злоумышленник попытается подменить сообщение, то он не сможет сформировать верный MAC из-за отсутствия правильного ключа и его сообщение будет отвергнуто получателем. Эта схема требует наличия общего секретного ключа у отправителя и получателя.</span></p>
<p class=rvps767><span class=rvts4>Простейшим способом генерации MAC является:</span></p>
<p class=rvps969><img width=124 height=36 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00443.png"><span class=rvts4>,</span></p>
<p class=rvps1340><span class=rvts4>где </span><span class=rvts51>h </span><span class=rvts1639>−</span><span class=rvts51> </span><span class=rvts4>хэш-функция, </span><span class=rvts51>k</span><span class=rvts4> </span><span class=rvts1639>−</span><span class=rvts4> секретный ключ, </span><span class=rvts51>M</span><span class=rvts4> </span><span class=rvts1639>−</span><span class=rvts4> сообщение.</span></p>
<p class=rvps767><span class=rvts4>Другим, </span><span class=rvts30>более стойким способом</span><span class=rvts4> является алгоритм HMAC:</span><img width=175 height=41 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00444.png"><span class=rvts4>.</span></p>
<h4 class=rvps1331><span class=rvts0><span class=rvts50>Выполнение ЭЦП</span></span></h4>
<p class=rvps767><span class=rvts4>Так как ЭЦП является функцией сообщения, то она должна зависеть от всех бит подписываемого текста. Так как ЭЦП применяется для блоков данных размера не больше заданного, то пришлось бы подписывать каждую часть сообщения отдельно, при этом длина ЭЦП была бы сравнимой с длиной </span><span class=rvts38>сообщения, а время подписи зависело бы линейно от объема</span><span class=rvts4> данных. Использование хэш-функции позволяет упростить реализацию ЭЦП, которая вычисляется не от самого сообщения, а от его хэша. При этом ЭЦП будет зависеть от всех бит сообщения, но будет иметь небольшую длину и вычисляться значительно быстрее. Очевидно, что если хэш-функция будет взломана, то будет взломана и ЭЦП его использующая, поэтому хэш функция является исключительно важным криптографическим примитивом.</span></p>
<p class=rvps767><span class=rvts4><br></span></p>
<h4 class=rvps1331><span class=rvts0><span class=rvts50>Проверка ключей</span></span></h4>
<p class=rvps767><span class=rvts4>Одной из важных областей применения хэш-функций является безопасная проверка паролей пользователя. Если пароли пользователей хранятся в базе данных, то при хищении базы данных злоумышленник получает доступ к данным всех пользователей. Альтернативой этому способу является хранение паролей пользователей в форме хэш-функции от пароля (ключа). При первом вводе ключа перед его использованием вычисляется значение хэш-функции от этого ключа и сохраняется в открытом виде в базе данных. При последующем вводе ключа, перед его использованием повторно, вычисляется значение хэш-функции и сравнивается с уже сохраненным значением. При их несовпадении делается вывод о неверности введенного ключа. Это позволяет защитить систему в случае хищения базы с паролями, так как в этом случае вместо паролей злоумышленник получит хэши, а подобрать какой-нибудь пароль из базы хэшей практически невозможно на практике при условии использования хорошей хэш-функции и качественного пароля или парольной фразы. Злоумышленник может составить базу данных хэшей от наиболее употребительных паролей и искать совпадения с базой паролей пользователей. Для защиты от этого используются так называемые "подсоленые" пароли, т. е. которые состоят из пароля пользователя и присоединенной к нему случайной строки длиной 16 байт. От итогового пароля вычисляется хэш для хранения в базе данных паролей, причем случайная строка хранится вместе с хэш-значением. В этом случае злоумышленнику придется составлять всю базу для каждого пароля, что не имеет смысла.</span></p>
<p class=rvps767><span class=rvts4><br></span></p>
<h4 class=rvps1331><span class=rvts0><span class=rvts50>Компактное хранение некоторого множества</span></span></h4>
<p class=rvps767><span class=rvts4>Для хранения данных о том, какие элементы присутствуют в множестве без раскрытия этих элементов может использоваться алгоритм, основанный на использовании хэш-функций и называемый "фильтр Блума". Фильтр Блума </span><span class=rvts1638>−</span><span class=rvts4> вероятностный метод хранения некоторого множества с возможностью определения принадлежности элементов к этому множеству. При этом есть вероятность ложноположительного срабатывания, не ложноотрицательного. Управлять вероятностью ложного срабатывания можно изменяя объем памяти, занимаемый алгоритмом, чем больше памяти, тем меньше вероятность ложного срабатывания. Хранилище </span><span class=rvts1638>−</span><span class=rvts4> это битовый массив. Фильтр Блума определяется размером занимаемой памяти и набором независимых различных хэш-функций. Для добавления элемента в множество (файла, текстового сообщения, слова, IP-пакета) вычисляются хэш-функции от этого элемента и биты значения этих функций устанавливаются в 1 (рис. 4.28). Для проверки принадлежности элементов, вычисляются значения хэш-функций и проверяется, есть ли в хранилище единичные элементы на соответствующих позициях.</span></p>
<div class=rvps969><table border=0 cellpadding=4 cellspacing=0 style="border-width: 0px; border-spacing: 0px; margin: 0px auto;">
<tr valign=top>
<td width=938 valign=top style="padding: 0px 7px;"><p class=rvps969><img alt="" style="padding : 1px;" src="img/img_00445.png"></p>
</td>
</tr>
<tr valign=top>
<td width=938 valign=top style="padding: 0px 7px;"><p class=rvps1339><span class=rvts51>Рис. 4.28. Пример фильтра Блума для хранилища 20 бит с тремя элементами и тремя хэш-функциями</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps767><span class=rvts4><br></span></p>
<p class=rvps767><span class=rvts4>Вероятность ложного срабатывания равна:</span></p>
<p class=rvps969><img width=119 height=49 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00446.png"><span class=rvts4>,</span></p>
<p class=rvps1243><span class=rvts4>где </span><span class=rvts51>k</span><span class=rvts4> – количество хэш-функций, </span><span class=rvts51>m</span><span class=rvts4> </span><span class=rvts1638>−</span><span class=rvts4> размер хранилища в битах, </span><span class=rvts51>n</span><span class=rvts4> </span><span class=rvts1638>−</span><span class=rvts4> количество элементов в хранилище. Оптимальное количество хэш-функций равно:</span></p>
<p class=rvps969><img width=83 height=49 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00447.png"><span class=rvts4>.</span></p>
<p class=rvps767><span class=rvts4>Применение такого фильтра позволяет в ряде случаев сократить требуемый объем памяти на несколько порядков, используется для автоматического определения саморассылающихся вирусов в коммутаторах, проверки существования имен и паролей, проверки некоторого значения без публикации базы данных и т. д.</span></p>
<p class=rvps969><span class=rvts4><br></span></p>
<p class=rvps1338 style="page-break-before: always;"><span class=rvts4><br></span></p>
<p class=rvps767><span class=rvts4><br></span></p>

                    </div>
					<div class="row">
						<div class="col-xs-6">
						<a title="К предыдущей главе" href="780.html" class="btn btn-default btn-sm" id="menu-toggle"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Назад</a>							
						</div>
						<div class="col-xs-6 text-right">
						<a title="К следующей главе" href="1780.html" class="btn btn-default btn-sm" id="menu-toggle">Вперед<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>							
						</div>
					</div>
                </div>
            </div>
<footer>
        <hr>
        <p><p class=rvps2><span class=rvts4><br></span></p>
</p>
      </footer>			
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="theme/jquery-1.12.1.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="theme/bootstrap.min.js"></script>

    <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>

</body>

</html>