<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Без названия.&nbsp;3.4.2. Таблица распределения разностей, построение дифференциальной модели</title>
    <meta charset="UTF-8"> 
    <meta name="generator" content="SunRav BookEditor"> 	
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="3.4.2. Таблица распределения разностей, построение дифференциальной модели">
    <link href="theme/bootstrap.min.css" rel="stylesheet">
    <link href="theme/simple-sidebar.css" rel="stylesheet">
	<link href="styles.css" rel="stylesheet">   

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav"><li class="sidebar-brand"><a href="index.html">Без названия</a></li><li ><a href='20.html'>&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Учебное пособие КМЗИ</a></li><li ><a href='1160.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Титульный экран</a></li><li ><a href='1170.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Оглавление</a></li><li ><a href='40.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Предисловие</a></li><li ><a href='50.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;1. Основы криптографии как науки о засекречивании информации</a></li><li ><a href='70.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;2. Криптографические нападения и понятие о криптоанализе, надежность шифров</a></li><li ><a href='80.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3. Современные блочные шифры и методы из криптоанализа</a></li><li ><a href='170.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3.1. Классические блочные алгоритмы шифрования. Альтернативные варианты построения блочных шифров</a></li><li ><a href='180.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3.2. Примеры блочных шифров</a></li><li ><a href='580.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;3.3. Классификация методов криптоанализа блочных шифров</a></li><li ><a href='190.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3.4. Основы дифференциального криптоанализа блочных шифров</a></li><li ><a href='590.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;3.4.1. Основные понятия дифференциального криптоанализа</a></li><li class='sidebar-active'><a href='600.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;3.4.2. Таблица распределения разностей, построение дифференциальной модели</a></li><li ><a href='610.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;3.4.3. Выполнение поиска ключа, оценивание сложности дифференциального криптоанализа</a></li><li ><a href='1730.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Контрольные вопросы</a></li><li ><a href='200.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3.5. Линейный криптоанализ блочных шифров</a></li><li ><a href='210.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;3.6. Интегральный и алгебраический криптоанализ блочных шифров</a></li><li ><a href='1270.html'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Тест к главе 3</a></li><li ><a href='90.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;4. Вспомогательные криптографические примитивы</a></li><li ><a href='100.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;5. Криптосистемы с открытым ключом</a></li><li ><a href='110.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;6. Криптографические методы в современных средствах защиты информации в компьютерных системах</a></li><li ><a href='1320.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-folder-close' aria-hidden='true'></span>&nbsp;Справочные материалы</a></li><li ><a href='2020.html'>&nbsp;&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-file' aria-hidden='true'></span>&nbsp;Список литературы</a></li>            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <h1><a title="Показать/скрыть меню" href="#menu-toggle" class="btn btn-default" id="menu-toggle"><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span></a> 3.4.2. Таблица распределения разностей, построение дифференциальной модели</h1>
						<hr>
                        <h3 class=rvps1137><span class=rvts0><span class=rvts29>3.4.2. Таблица распределения разностей, построение дифференциальной модели</span></span></h3>
<p class=rvps1047><span class=rvts4>Дифференциальный криптоанализ основан на свойствах, используемых в алгоритме шифрования нелинейных операций(подстановок). Исходными данными для дифференциального криптоанализа являются пары открытых текстов и соответствующие им пары шифртекстов. Дифференциальные свойства подстановок отражаются в таблице распределения разностей. Она строится таким образом, что в ней содержатся статистические свойства всех возможных входных разностей и соответствующих им выходных разностей. Пусть на вход некоторой подстановки подаются пары значений </span><img width=52 height=27 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00232.png"><span class=rvts4>, имеющие размерность равную размерности подстановки и фиксированное значение разности </span><img width=111 height=27 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00233.png"><span class=rvts4>. Рассмотрим все возможные значения разности между двумя входными значениями. Очевидно, что всего таких разностей будет </span><img width=22 height=27 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00234.png"><span class=rvts4>, где </span><span class=rvts51>n</span><span class=rvts4> – размерность входа подстановки. Эти значения будут соответствовать строкам таблицы распределения разностей, причем значение разности в шестнадцатеричном виде является первым элементом строки. Столбцы будут соответствовать выходным разностям, т.&nbsp;е. полученным после преобразования с помощью подстановки значений, составляющих входные разности. В результате такого преобразования из пар значений с заданной разностью</span><img width=114 height=27 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00235.png"><span class=rvts4>с помощью подстановки преобразуются в </span><img width=98 height=27 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00236.png"><span class=rvts4>, где разность </span><img width=31 height=18 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00237.png"><span class=rvts4> соответствует столбцам таблицы. Значением ячеек таблицы является количество появления определенной выходной разности для заданной входной. Так, например, для всех возможных входных разностей равных 0x0a после преобразования с помощью подстановки преобразуются в разности, в которых 10 раз встречается разность 0x08. То есть вероятность того, что при входной разности 0x0a встретится выходная разность 0x08 равна </span><img width=24 height=49 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00238.png"><span class=rvts4>. Рассмотрим, как выполняется построение таблицы распределения разностей. Сначала первый столбец и первая строка заполняются нулевыми значениями. Это означает, что если сумма входных значений равна 0, т. е. они одинаковые, то и сумма выходных значений тоже будет равна 0, так как одинаковые входные значения преобразуются в одинаковые выходные значения.</span></p>
<p class=rvps1047><span class=rvts4>Таблица распределения разностей, приведенная на рис. 3.33, соответствует подстановке из табл. 3.7.</span></p>
<p class=rvps1047><span class=rvts4><br></span></p>
<p class=rvps1145><span class=rvts51>Таблица 3.7</span></p>
<p class=rvps1146><span class=rvts30>Пример подстановки размером 4 бита</span></p>
<div class=rvps1144><table width="100%" border=1 cellpadding=4 cellspacing=-1 style="border-width: 0px; border-collapse: collapse;">
<tr valign=top>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>0</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>1</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>2</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>3</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>4</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>5</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>6</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>7</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>8</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>9</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>A</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>B</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>C</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>D</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>E</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>F</span></p>
</td>
</tr>
<tr valign=top>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>0</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>6</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>7</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>9</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>B</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>5</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>E</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>4</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>A</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>1</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>8</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>2</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>F</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>C</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>3</span></p>
</td>
<td width="6%" valign=top style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps99><span class=rvts41>D</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps22><span class=rvts38><br></span></p>
<p class=rvps1139><img width=615 height=339 alt="" style="padding : 1px;" src="img/img_00239.png"></p>
<p class=rvps1027><span class=rvts95>Рис. 3.33. Пример таблицы распределения разностей</span></p>
<p class=rvps4><span class=rvts4><br></span></p>
<p class=rvps767><span class=rvts4>Далее приведен алгоритм генерации одной строки таблицы распределения разностей для подстановки, приведенной в таблице 3.8 для построения строки таблицы с входной разностью 01h. Для этого сгенерируем все возможные пары значений из трех бит так, чтобы сумма по модулю 2 (она же разность) каждой пары была равна 01h. Сначала берем все возможные значения от 0 до </span><img width=35 height=27 alt="" style="vertical-align: text-bottom; padding : 1px;" src="img/img_00240.png"><span class=rvts4>, это будут первые значения в парах. Вторые значения получаем, прибавляя к первым наше искомое значение разности 01h. Таким образом, получим 8 различных пар значений, причем сумма любой пары дает 01h. После этого, все значения пар пропускаем через подстановку, </span><span class=rvts38>приведенную в таблице 3.8, и вычисляем</span><span class=rvts4>, сколько раз при этом встретилось разных значений суммы по модулю 2 при суммировании каждой пары. Количество каждых уникальных значений суммы записываем в ячейку таблицы, где строка </span><span class=rvts1638>−</span><span class=rvts4> это 01, а столбец </span><span class=rvts1638>−</span><span class=rvts4> это значение суммы. Схема этого алгоритма приведена на рис. 3.34.</span></p>
<p class=rvps767><span class=rvts4><br></span></p>
<p class=rvps1147><span class=rvts51>Таблица 3.8</span></p>
<p class=rvps22><span class=rvts30>Пример подстановки размерности 3 бита</span></p>
<div class=rvps1141><table width="80%" border=1 cellpadding=4 cellspacing=-1 style="border-width: 0px; border-collapse: collapse; margin: 0px auto;">
<tr valign=top>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>0</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>1</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>2</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>3</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>4</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>5</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>6</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>7</span></p>
</td>
</tr>
<tr valign=top>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>1</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>0</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>6</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>4</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>5</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>3</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>7</span></p>
</td>
<td width="12%" valign=middle style="border-width : 1px; border-color: #000000; border-style: solid; padding: 0px 7px;"><p class=rvps43><span class=rvts4>2</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps317><span class=rvts4><br></span></p>
<p class=rvps317><span class=rvts4>В результате выполнения вычисления мы видим, что значение 001 встречается 2 раза, это значение стоит в ячейке с координатами 01h*01h, так же вычисляются значения для столбца 2(010), 5(101) и 6(110), что можно увидеть в строке с номером 01. Этот результат означает, что для входной разности 01 вероятность выходной разности 01 равны </span><img width=67 height=49 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00241.png"><span class=rvts4>, такие же вероятности имеют значения 2, 5,6. Вероятность появления остальных значений разности равна нулю. Очевидно, что дифференциальный криптоанализ работает потому, что все операции, кроме подстановки, изменяя значение данных в процессе шифрования, не изменяют значения их разности (суммы по модулю два).</span></p>
<p class=rvps4><span class=rvts4><br></span></p>
<div class=rvps43><table border=0 cellpadding=4 cellspacing=0 style="border-width: 0px; border-spacing: 0px; margin: 0px auto;">
<tr valign=top>
<td width=1075 valign=top style="padding: 0px 7px;"><p class=rvps43><img alt="" style="padding : 1px;" src="img/img_00242.png"></p>
</td>
</tr>
<tr valign=top>
<td width=1075 valign=top style="padding: 0px 7px;"><p class=rvps1002><span class=rvts51>Рис. 3.34. Схематичное изображение процесса заполнения ячеек </span><span class=rvts95>таблицы распределения разностей</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps4><span class=rvts4><br></span></p>
<p class=rvps317><span class=rvts4>Каждой ячейке таблицы распределения разностей соответствует пара значений, состоящая из входной и выходной разности, которая называется дифференциалом и обозначается как </span><img width=76 height=28 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00243.png"><span class=rvts4>. Значение в ячейке, деленное на </span><img width=24 height=23 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00244.png"><span class=rvts4>, является вероятностью появления определенного дифференциала. В идеале, вероятность появления каждой выходной разности, при любой входной, должна быть равна </span><img width=29 height=49 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00245.png"><span class=rvts4>, в реальности идеальных подстановок не бывает, и вероятности разных дифференциалов отличаются друг от друга. Дифференциальный анализ использует отклонение вероятности дифференциалов от теоретического значения для некоторых входных разностей для построения дифференциальной модели всего шифра.</span></p>
<p class=rvps317><span class=rvts4>Для построения дифференциальной модели всего шифра необходимо выбрать наиболее подходящие дифференциалы из таблицы распределения разностей с помощью двух критериев:</span></p>
<p class=rvps595><span class=rvts1640>−</span><span class=rvts31> необходимо выбирать дифференциалы с максимальной вероятностью;</span></p>
<p class=rvps595><span class=rvts1640>−</span><span class=rvts31> необходимо выбирать дифференциалы с минимального весом </span><a class=rvts2807 href="1470.html"  OnClick="javascript:NewWindow=window.open('1470.html','NewWindow','width=700,height=700,menubar=no,scrollbars');return false;">Хэмминга</a><span class=rvts31> выходной разности.</span></p>
<p class=rvps317><span class=rvts51>Вес Хэмминга для некоторого значения или вектора — это количество бит, которые равны 1.</span><span class=rvts4> </span></p>
<p class=rvps317><span class=rvts4>После анализа подстановок в шифре в первом раунде можно начинать построение дифференциальной модели всего блочного шифра. Для того, чтобы это сделать, необходимо для подстановки первого раунда выбрать дифференциал в соответствии с двумя приведенными критериями, а для всех последующих раундов необходимо выбирать дифференциалы так, чтобы выход предыдущего раунда (ненулевые биты) стал входом следующего раунда и так далее до предпоследнего раунда. В дифференциальной модели алгоритма шифрования недопустимы «висячие ветки» и дифференциалы с нулевой вероятностью. Эта модель имеет свое входное значение разности открытых текстов и выходное значение разности шифртекстов, желательно, чтобы количество подстановок, которые в ней участвуют, было минимальным.</span></p>
<p class=rvps317><span class=rvts4>Рассмотрим пример построения дифференциальной модели всего шифра. Для ее построения используем учебный шифр (рис. 3.35). </span></p>
<div class=rvps597><table border=0 cellpadding=1 cellspacing=2 style="border-width: 0px; background-color: #ffffff; border-spacing: 2px; margin: 0px auto;">
<tr valign=top>
<td width=1070 style="padding: 1px;"><p class=rvps597><img alt="" style="padding : 1px;" src="img/img_00246.png"></p>
</td>
</tr>
<tr valign=top>
<td width=1070 style="padding: 1px;"><p class=rvps1039><span class=rvts95>Рис. 3.35. Структура учебного блочного шифра</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps317><span class=rvts4><br></span></p>
<p class=rvps317><span class=rvts4>Тестовый шифр состоит из 4 раундов, в нем используются одинаковые подстановки размером 4 бита в качестве нелинейного преобразования, перестановка в качестве линейного преобразования и добавления подключа с помощью операции сложения по модулю 2.</span></p>
<p class=rvps317><span class=rvts4>В качестве начального дифференциала выбираем (05, 04) с вероятностью 0,5 в 1-й подстановке первого раунда. Его выход после перестановки поступает на вход третьей подстановки второго раунда, 3-й бит (при отсчете с нуля). В качестве второго дифференциала выбираем (08,01) с вероятностью 0,5. Далее выход этого дифференциала после перестановки поступает на вход четвертой подстановки третьего раунда (2 бит).</span></p>
<p class=rvps317><span class=rvts4>Таблица распределения разностей для выбранной случайной подстановки представлена на рис. 3.36. </span></p>
<p class=rvps317><span class=rvts4><br></span></p>
<div class=rvps597><table border=0 cellpadding=4 cellspacing=0 style="border-width: 0px; border-spacing: 0px; margin: 0px auto;">
<tr valign=top>
<td width=610 valign=top style="padding: 0px 7px;"><p class=rvps597><img alt="" style="padding : 1px;" src="img/img_00247.png"></p>
</td>
</tr>
<tr valign=top>
<td width=610 valign=top style="padding: 0px 7px;"><p class=rvps1039><span class=rvts95>Рис. 3.36. Таблица распределения разностей</span></p>
</td>
</tr>
</table>
</div>
<p class=rvps597><span class=rvts4><br></span></p>
<p class=rvps317><span class=rvts4364>Дифференциалом третьего раунда выбираем (04, 01) с вероятностью 0,5. Дифференциальная модель всего шифра записывается как </span><img width=98 height=28 alt="" style="padding : 1px;" src="img/img_00248.png"><span class=rvts4364>.</span></p>
<p class=rvps317><span class=rvts4364>Вероятность этой модели равна произведению вероятностей дифференциалов </span><img width=85 height=60 alt="" style="vertical-align: middle; padding : 1px;" src="img/img_00249.png"><span class=rvts4364>, в нашем случае &nbsp;</span><img width=185 height=20 alt="" style="padding : 1px;" src="img/img_00250.png"><span class=rvts4364>. Это означает, что при заданной входной разности 05 на выходе шифра получится разность 01 с вероятностью 0.125. Чем выше вероятность, тем легче проводить криптоанализ.</span></p>
<p class=rvps317><span class=rvts51>Из этой формулы становится понятно, почему должно быть, как можно меньше дифференциалов в модели, а, следовательно, почему выходной вес Хэмминга для выходных разностей дифференциалов должен быть минимальным. Также, если вероятность дифференциала равна нулю, то все выражение равно нулю, т. е. криптоанализ невозможен.</span></p>
<p class=rvps317><span class=rvts4>С помощью этой модели, и определенного количества данных вида выбранный открытый текст/шифртекст, можно найти часть ключа, </span><span class=rvts38>показанную на рисунке 3.35 красным </span><span class=rvts4>овалом. Для нахождения остальных частей последнего ключа необходимо построить другие модели, влияющие на другие финальные подстановки. После нахождения всего последнего подключа выполняется частичное расшифрование используемых шифртекстов, а именно расшифрование последнего раунда. После этого, таким же образом выполняется поиск предыдущего ключа и так далее до получения всех подключей шифрования.</span></p>
<p class=rvps317 style="page-break-before: always;"><span class=rvts4><br></span></p>
<p class=rvps317><span class=rvts4><br></span></p>

                    </div>
					<div class="row">
						<div class="col-xs-6">
						<a title="К предыдущей главе" href="590.html" class="btn btn-default btn-sm" id="menu-toggle"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Назад</a>							
						</div>
						<div class="col-xs-6 text-right">
						<a title="К следующей главе" href="610.html" class="btn btn-default btn-sm" id="menu-toggle">Вперед<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>							
						</div>
					</div>
                </div>
            </div>
<footer>
        <hr>
        <p><p class=rvps2><span class=rvts4><br></span></p>
</p>
      </footer>			
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="theme/jquery-1.12.1.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="theme/bootstrap.min.js"></script>

    <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>

</body>

</html>